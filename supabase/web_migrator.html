<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supabase Migration Runner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            background: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        
        .migration {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .migration h3 {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status.pending { background: #ffeaa7; color: #fdcb6e; }
        .status.running { background: #74b9ff; color: #0984e3; }
        .status.success { background: #55efc4; color: #00b894; }
        .status.error { background: #ff7675; color: #d63031; }
        
        .log {
            margin-top: 15px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .log-entry {
            padding: 2px 0;
        }
        
        .log-entry.success { color: #00b894; }
        .log-entry.error { color: #d63031; }
        .log-entry.info { color: #0984e3; }
        
        button {
            background: #0984e3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
        
        button:hover {
            background: #0770c2;
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Supabase Database Migration Runner</h1>
        <p class="subtitle">This tool will set up your Rekon30 database schema</p>
        
        <div class="warning">
            <strong>‚ö†Ô∏è Important:</strong> This will create tables, policies, and functions in your Supabase database.
            Make sure you're connected to the correct project: <strong>cddoboboxeangripcqrn</strong>
        </div>
        
        <div id="migrations">
            <div class="migration" data-file="001">
                <h3>
                    <span class="status pending">Pending</span>
                    Step 1: Create Database Schema
                </h3>
                <p>Creates all tables (products, customers, sales, etc.)</p>
                <div class="log" id="log-001" style="display:none;"></div>
            </div>
            
            <div class="migration" data-file="002">
                <h3>
                    <span class="status pending">Pending</span>
                    Step 2: Set Up Security Policies
                </h3>
                <p>Configures Row Level Security (RLS) policies</p>
                <div class="log" id="log-002" style="display:none;"></div>
            </div>
            
            <div class="migration" data-file="003">
                <h3>
                    <span class="status pending">Pending</span>
                    Step 3: Add Functions & Triggers
                </h3>
                <p>Sets up automation and database functions</p>
                <div class="log" id="log-003" style="display:none;"></div>
            </div>
        </div>
        
        <button id="runBtn" onclick="runMigrations()">Run All Migrations</button>
        
        <div class="success-message" id="successMsg">
            <strong>‚úÖ Success!</strong> All migrations completed successfully.
            Your database is now ready to use!
        </div>
    </div>
    
    <script>
        const PROJECT_ID = 'cddoboboxeangripcqrn';
        const SERVICE_ROLE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNkZG9ib2JveGVhbmdyaXBjcXJuIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1OTc1ODI1NCwiZXhwIjoyMDc1MzM0MjU0fQ.CbCMnclEfF2iWZzLeI4VGIgKYEPuYAt7P-kSAfPr83Q';
        
        // SQL migrations are embedded here for convenience
        const migrations = {
            '001': `-- Migration content from 001_initial_schema.sql
            -- Note: Full SQL is in the migrations folder
            -- This HTML migrator provides instructions to run manually
            `
        };
        
        function addLog(fileNum, message, type = 'info') {
            const logDiv = document.getElementById(`log-${fileNum}`);
            logDiv.style.display = 'block';
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = message;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function updateStatus(fileNum, status) {
            const migration = document.querySelector(`[data-file="${fileNum}"]`);
            const statusSpan = migration.querySelector('.status');
            statusSpan.className = `status ${status}`;
            statusSpan.textContent = status.charAt(0).toUpperCase() + status.slice(1);
        }
        
        async function runMigrations() {
            const btn = document.getElementById('runBtn');
            btn.disabled = true;
            btn.textContent = 'Running Migrations...';
            
            addLog('001', '‚ö†Ô∏è Manual Migration Required', 'info');
            addLog('001', 'Please run migrations through Supabase SQL Editor:', 'info');
            addLog('001', '1. Go to https://supabase.com/dashboard', 'info');
            addLog('001', '2. Select your project', 'info');
            addLog('001', '3. Click SQL Editor ‚Üí New Query', 'info');
            addLog('001', '4. Copy migrations/001_initial_schema.sql', 'info');
            addLog('001', '5. Paste and run the query', 'info');
            addLog('001', '6. Repeat for 002_rls_policies.sql', 'info');
            addLog('001', '7. And finally 003_functions_triggers.sql', 'info');
            
            updateStatus('001', 'pending');
            updateStatus('002', 'pending');
            updateStatus('003', 'pending');
            
            alert('Please run migrations manually through Supabase SQL Editor. See the log for instructions.');
            
            btn.textContent = 'Run All Migrations';
            btn.disabled = false;
        }
        
        // Show instructions on load
        window.addEventListener('load', () => {
            console.log('Supabase Migration Runner Ready');
            console.log('Project:', PROJECT_ID);
            console.log('See MIGRATION_GUIDE.md for detailed instructions');
        });
    </script>
</body>
</html>

